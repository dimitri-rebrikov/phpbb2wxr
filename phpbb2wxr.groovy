import groovy.sql.*import org.apache.log4j.LoggerLogger log = Logger.getLogger('')tablePrefix = 'phpbb_'tableForums = tablePrefix + 'forums'tableTopics = tablePrefix + 'topics'log.info('connect to the phpbb database')sql = Sql.newInstance('jdbc:mysql://localhost:3306/phpbb', 'root', '', 'org.gjt.mm.mysql.Driver')log.info('iterate over the forums table')sql.eachRow('select forum_id from ' + tableForums + ' order by forum_id ') { frow ->	def forum = getForum(frow.forum_id)	log.trace("Forum $forum.id $forum.name parent: ${forum.parent?.name}")	sql.eachRow('select topic_id from ' + tableTopics + ' where forum_id = ? order by topic_id', [forum.id]) { trow ->		def topic = getTopic(trow.topic_id)		log.trace("Topic $topic.id $topic.name")		}	}def getForum(id) {	def row = sql.firstRow('select * from ' + tableForums + ' where forum_id=?', [id])	def forum = [id:row.forum_id, name:row.forum_name]	forum.parent = row.parent_id ? getForum(row.parent_id) : null	return forum}def getTopic(id) {	def row = sql.firstRow('select * from ' + tableTopics + ' where topic_id=?', [id])	def topic = [id:row.topic_id, name:row.topic_title]	return topic}